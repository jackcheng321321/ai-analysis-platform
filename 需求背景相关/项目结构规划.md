# AI综合分析管理平台 - 项目结构规划

## 完整项目结构

```
ai-analysis-platform/
├── README.md                           # 项目说明文档
├── docker-compose.yml                  # Docker编排配置
├── docker-compose.dev.yml              # 开发环境配置
├── .env.example                        # 环境变量示例
├── .gitignore                          # Git忽略文件
│
├── backend/                            # 后端服务
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py                     # FastAPI应用入口
│   │   ├── config.py                   # 配置管理
│   │   │
│   │   ├── api/                        # API路由
│   │   │   ├── __init__.py
│   │   │   ├── deps.py                 # 依赖注入
│   │   │   ├── webhooks.py             # Webhook相关API
│   │   │   ├── models.py               # AI模型配置API
│   │   │   ├── storage.py              # 存储凭证API
│   │   │   ├── tasks.py                # 分析任务API
│   │   │   └── monitoring.py           # 监控API
│   │   │
│   │   ├── core/                       # 核心配置
│   │   │   ├── __init__.py
│   │   │   ├── config.py               # 应用配置
│   │   │   ├── database.py             # 数据库配置
│   │   │   ├── security.py             # 安全配置
│   │   │   └── logging.py              # 日志配置
│   │   │
│   │   ├── models/                     # 数据模型
│   │   │   ├── __init__.py
│   │   │   ├── base.py                 # 基础模型
│   │   │   ├── ai_model.py             # AI模型配置
│   │   │   ├── storage.py              # 存储凭证
│   │   │   ├── webhook.py              # Webhook配置
│   │   │   ├── task.py                 # 分析任务
│   │   │   └── execution.py            # 执行记录
│   │   │
│   │   ├── schemas/                    # Pydantic模式
│   │   │   ├── __init__.py
│   │   │   ├── ai_model.py
│   │   │   ├── storage.py
│   │   │   ├── webhook.py
│   │   │   ├── task.py
│   │   │   └── execution.py
│   │   │
│   │   ├── services/                   # 业务逻辑服务
│   │   │   ├── __init__.py
│   │   │   ├── webhook_service.py      # Webhook处理
│   │   │   ├── file_service.py         # 文件获取
│   │   │   ├── ai_service.py           # AI分析
│   │   │   ├── feishu_service.py       # 飞书集成
│   │   │   ├── encryption_service.py   # 加密服务
│   │   │   └── monitoring_service.py   # 监控服务
│   │   │
│   │   ├── tasks/                      # Celery异步任务
│   │   │   ├── __init__.py
│   │   │   ├── celery_app.py           # Celery应用
│   │   │   ├── webhook_tasks.py        # Webhook处理任务
│   │   │   └── analysis_tasks.py       # 分析任务
│   │   │
│   │   ├── utils/                      # 工具函数
│   │   │   ├── __init__.py
│   │   │   ├── json_path.py            # JSONPath解析
│   │   │   ├── file_utils.py           # 文件处理工具
│   │   │   ├── template_engine.py      # 模板引擎
│   │   │   └── validators.py           # 验证器
│   │   │
│   │   └── tests/                      # 测试文件
│   │       ├── __init__.py
│   │       ├── conftest.py
│   │       ├── test_api/
│   │       ├── test_services/
│   │       └── test_utils/
│   │
│   ├── alembic/                        # 数据库迁移
│   │   ├── versions/
│   │   ├── env.py
│   │   ├── script.py.mako
│   │   └── alembic.ini
│   │
│   ├── requirements.txt                # Python依赖
│   ├── requirements-dev.txt            # 开发依赖
│   ├── Dockerfile                      # Docker镜像
│   ├── Dockerfile.dev                  # 开发环境Docker
│   └── pytest.ini                     # 测试配置
│
├── frontend/                           # 前端应用
│   ├── public/
│   │   ├── index.html
│   │   └── favicon.ico
│   │
│   ├── src/
│   │   ├── main.ts                     # 应用入口
│   │   ├── App.vue                     # 根组件
│   │   │
│   │   ├── components/                 # 通用组件
│   │   │   ├── common/                 # 基础组件
│   │   │   │   ├── PageHeader.vue
│   │   │   │   ├── DataTable.vue
│   │   │   │   └── ConfirmDialog.vue
│   │   │   │
│   │   │   ├── forms/                  # 表单组件
│   │   │   │   ├── ModelConfigForm.vue
│   │   │   │   ├── StorageConfigForm.vue
│   │   │   │   └── TaskConfigWizard.vue
│   │   │   │
│   │   │   └── charts/                 # 图表组件
│   │   │       ├── TokenUsageChart.vue
│   │   │       └── ExecutionChart.vue
│   │   │
│   │   ├── views/                      # 页面组件
│   │   │   ├── Dashboard.vue           # 仪表板
│   │   │   ├── config/                 # 配置管理
│   │   │   │   ├── ModelConfig.vue
│   │   │   │   └── StorageConfig.vue
│   │   │   ├── webhook/                # Webhook管理
│   │   │   │   ├── WebhookList.vue
│   │   │   │   └── WebhookDetail.vue
│   │   │   ├── task/                   # 任务管理
│   │   │   │   ├── TaskList.vue
│   │   │   │   ├── TaskCreate.vue
│   │   │   │   └── TaskDetail.vue
│   │   │   └── monitoring/             # 监控分析
│   │   │       ├── ExecutionHistory.vue
│   │   │       └── Analytics.vue
│   │   │
│   │   ├── router/                     # 路由配置
│   │   │   └── index.ts
│   │   │
│   │   ├── stores/                     # 状态管理
│   │   │   ├── index.ts
│   │   │   ├── auth.ts
│   │   │   ├── config.ts
│   │   │   └── task.ts
│   │   │
│   │   ├── api/                        # API调用
│   │   │   ├── index.ts
│   │   │   ├── config.ts
│   │   │   ├── webhook.ts
│   │   │   ├── task.ts
│   │   │   └── monitoring.ts
│   │   │
│   │   ├── utils/                      # 工具函数
│   │   │   ├── request.ts              # HTTP请求封装
│   │   │   ├── format.ts               # 格式化工具
│   │   │   └── validation.ts           # 验证工具
│   │   │
│   │   ├── types/                      # TypeScript类型定义
│   │   │   ├── api.ts
│   │   │   ├── config.ts
│   │   │   └── task.ts
│   │   │
│   │   └── assets/                     # 静态资源
│   │       ├── styles/
│   │       │   ├── main.css
│   │       │   └── variables.css
│   │       └── images/
│   │
│   ├── package.json                    # Node.js依赖
│   ├── package-lock.json
│   ├── tsconfig.json                   # TypeScript配置
│   ├── vite.config.ts                  # Vite配置
│   ├── Dockerfile                      # Docker镜像
│   ├── nginx.conf                      # Nginx配置
│   └── .eslintrc.js                    # ESLint配置
│
├── docs/                               # 文档目录
│   ├── api.md                          # API文档
│   ├── deployment.md                   # 部署文档
│   ├── development.md                  # 开发文档
│   └── user-guide.md                   # 用户指南
│
├── scripts/                            # 脚本目录
│   ├── init-db.sql                     # 数据库初始化
│   ├── backup.sh                       # 备份脚本
│   └── deploy.sh                       # 部署脚本
│
└── monitoring/                         # 监控配置
    ├── prometheus.yml                  # Prometheus配置
    ├── grafana/                        # Grafana配置
    └── alerts/                         # 告警规则
```

## 关键文件说明

### 后端关键文件

1. **app/main.py** - FastAPI应用入口，配置路由、中间件、CORS等
2. **app/config.py** - 应用配置，包括数据库连接、Redis配置等
3. **app/services/** - 核心业务逻辑，每个服务负责特定功能
4. **app/tasks/** - Celery异步任务，处理耗时操作
5. **app/models/** - SQLAlchemy数据模型
6. **app/schemas/** - Pydantic数据验证模式

### 前端关键文件

1. **src/main.ts** - Vue应用入口
2. **src/router/index.ts** - 路由配置
3. **src/stores/** - Pinia状态管理
4. **src/components/forms/TaskConfigWizard.vue** - 任务配置向导（核心组件）
5. **src/api/** - API调用封装

### 配置文件

1. **docker-compose.yml** - 生产环境容器编排
2. **docker-compose.dev.yml** - 开发环境容器编排
3. **.env.example** - 环境变量模板
4. **requirements.txt** - Python依赖列表
5. **package.json** - Node.js依赖列表

## 开发流程

### 1. 环境准备
```bash
# 克隆项目
git clone <repository-url>
cd ai-analysis-platform

# 复制环境变量
cp .env.example .env

# 启动开发环境
docker-compose -f docker-compose.dev.yml up -d
```

### 2. 后端开发
```bash
cd backend

# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 安装依赖
pip install -r requirements-dev.txt

# 运行数据库迁移
alembic upgrade head

# 启动开发服务器
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 3. 前端开发
```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

### 4. 测试
```bash
# 后端测试
cd backend
pytest

# 前端测试
cd frontend
npm run test
```

## 部署流程

### 1. 生产环境部署
```bash
# 构建并启动所有服务
docker-compose up -d

# 查看服务状态
docker-compose ps

# 查看日志
docker-compose logs -f
```

### 2. 数据库初始化
```bash
# 运行数据库迁移
docker-compose exec backend alembic upgrade head

# 创建初始数据
docker-compose exec backend python -m app.scripts.init_data
```

## 开发规范

### 1. 代码规范
- **Python**: 遵循PEP 8，使用black格式化，flake8检查
- **TypeScript**: 遵循ESLint规则，使用Prettier格式化
- **Git**: 使用Conventional Commits规范

### 2. 分支管理
- **main**: 主分支，用于生产环境
- **develop**: 开发分支，用于集成测试
- **feature/***: 功能分支
- **hotfix/***: 热修复分支

### 3. 测试策略
- **单元测试**: 覆盖率 > 80%
- **集成测试**: 关键业务流程
- **端到端测试**: 主要用户场景

### 4. 文档要求
- **API文档**: 使用FastAPI自动生成
- **代码注释**: 关键函数和复杂逻辑
- **README**: 项目说明和快速开始
- **变更日志**: 记录版本变更

这个项目结构设计充分考虑了可维护性、可扩展性和团队协作的需要，为项目的长期发展奠定了良好的基础。